# -----------------------------------------------------------------------------
# InferiaLLM Environment Configuration
# -----------------------------------------------------------------------------
# Configuration here is used for infrastructure and core security.
# Provider keys (AWS, OpenAI, Chroma, etc.) are now managed via the Dashbaord Config
# -----------------------------------------------------------------------------

# --- Database Configuration ---
# Used by Filtration, Inference, and Orchestration services
DATABASE_URL='postgresql://inferia:inferia@localhost:5432/inferia'
POSTGRES_DSN='postgresql://inferia:inferia@localhost:5432/inferia'
# Enable SSL for database connections (enabled by default, set to 'false' for local dev only)
DATABASE_SSL=true

# --- Redis Configuration ---
# Used for rate limiting and task queues
REDIS_HOST="localhost"
REDIS_PORT=6379
REDIS_DB="0"
REDIS_USERNAME="default"
REDIS_PASSWORD=
# Enable SSL for Redis connections (recommended for production)
REDIS_SSL=false

# --- Security & Authentication ---
# CRITICAL: Generate strong secrets for production using:
# openssl rand -hex 32
#
# NEVER use default values in production!

# Superadmin credentials - used for initial setup only
# Generate strong password: openssl rand -base64 24
SUPERADMIN_EMAIL="admin@example.com"
SUPERADMIN_PASSWORD="CHANGE_THIS_TO_STRONG_PASSWORD"

# JWT Secret Key - used for signing authentication tokens
# Generate: openssl rand -hex 32
JWT_SECRET_KEY="YOUR_32_BYTE_SECRET_KEY_HERE"

# Internal API Key - used for service-to-service authentication
# Generate: openssl rand -hex 32
INTERNAL_API_KEY="YOUR_32_BYTE_INTERNAL_API_KEY_HERE"

# Used for encrypting sensitive fields in the database
SECRET_ENCRYPTION_KEY="32-byte-base64-encoded-key"

# Used for encrypting audit logs
LOG_ENCRYPTION_KEY="32-byte-hex-key"

# --- Service Gateways ---
INFERENCE_PORT=8001
FILTRATION_PORT=8000
ORCHESTRATION_PORT=8080

# --- CORS Configuration ---
# Comma-separated list of allowed origins for all services
# In production, set this to your specific domains:
# ALLOWED_ORIGINS="https://app.yourdomain.com,https://admin.yourdomain.com"
# Default allows localhost development origins only
ALLOWED_ORIGINS="http://localhost:3000,http://localhost:5173,http://localhost:8001"

# --- Circuit Breaker Configuration ---
# Number of failures before opening circuit breaker
CIRCUIT_BREAKER_FAILURE_THRESHOLD=5
# Seconds to wait before attempting recovery
CIRCUIT_BREAKER_RECOVERY_TIMEOUT=30

# --- Rate Limiting Configuration ---
# Login attempts per minute per IP
LOGIN_RATE_LIMIT=5
# Registration attempts per hour per IP  
REGISTER_RATE_LIMIT=3
# Block duration in seconds after exceeding rate limit
RATE_LIMIT_BLOCK_DURATION=300

# --- Health Check Configuration ---
# Timeout for external service health checks (seconds)
HEALTH_CHECK_TIMEOUT=5
# Interval between health checks (seconds)
HEALTH_CHECK_INTERVAL=30

# --- Feature Flags ---
ENABLE_2FA=true
GUARDRAIL_PII_DETECTION_ENABLED=true